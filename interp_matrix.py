# <filename>.py
# <project>
# Author: miles at hyperlightcorp dot com
# Created: <date>
# Modified: <date>

# <description>

# -------10--------20--------30--------40--------50--------60--------70--------
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~imports~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

import numpy as np

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~/imports~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~user~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

yvals = np.atleast_2d((-0.216692445, -0.225557792, -0.212991264, -0.207435131, -0.22120515, -0.220411358, -0.228465265, -0.223979961, -0.210511687, -0.203076931, -0.195202553, -0.184242234, -0.177542917, -0.170880322, -0.167689989, -0.16173776, -0.158139654, -0.154753494, -0.15086389, -0.148003628, -0.147590635, -0.146185689, -0.142186052, -0.139845015, -0.137569522, -0.135452696, -0.133253914, -0.130583548, -0.129508418, -0.127283964, -0.124630167, -0.122575661, -0.120493317, -0.117845217, -0.116350988, -0.114408921, -0.11285784, -0.111463663, -0.109886588, -0.108109631, -0.106189712))

xvals = np.atleast_2d(np.arange(1509,1589+2,2))
xnew = np.atleast_2d(np.arange(1520,1580+0.6,0.6)).T



#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~/user~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~functions~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

def basic_interp(xnew,xvals,yvals):
    x1 = xvals[:,:-1]
    x2 = xvals[:,1:]
    y1 = yvals[:,:-1]
    y2 = yvals[:,1:]

    dydx = (y2 - y1)/(x2 - x1)
    bvals = y1 - x1 * dydx

    blurt = np.logical_and(xnew < x2, xnew >= x1).astype(int)
    hork = xnew.T * np.matmul(dydx,blurt.T) + np.matmul(bvals, blurt.T)
    
    return hork

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~/functions~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~main~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
if __name__ == "__main__":
    
    
    print(basic_interp(xnew, xvals, yvals).T)
    
    
    
    
#end if __name__ == "__main__"
